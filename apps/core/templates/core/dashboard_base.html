{% extends "core/base.html" %}
{% block title %}{% block dashboard_title %}Кабінет{% endblock %}{% endblock %}

{% block head_extra %}
  {{ block.super }}
  <style>
    /* EN: Sidebar styles; UA: стилі для сайдбару */
    .sidebar {
      width: 260px;
      min-height: calc(100vh - 56px); /* minus navbar height */
    }
    .sidebar .nav-link {
      border-radius: .375rem;
    }
    .sidebar .nav-link.active {
      background: rgba(255,255,255,.2);
      color: #fff;
      font-weight: 600;
    }
    @media (max-width: 991.98px) {
      .sidebar {
        width: 100%;
        min-height: auto;
      }
    }
  </style>
{% endblock %}

{% block content %}
<div class="row g-4">
  <!-- Sidebar -->
  <aside class="col-12 col-lg-2">
    <div class="sidebar bg-primary text-white rounded-3 p-3 shadow-sm">
      <div class="d-flex align-items-center mb-3">
        {% if request.user.customerprofile.avatar %}
          <img src="{{ request.user.customerprofile.avatar.url }}" width="40" height="40" class="rounded-circle me-2" alt="avatar">
        {% else %}
          <img src="/static/media/avatar.png" width="40" height="40" class="rounded-circle me-2" alt="avatar">
        {% endif %}
        <div>
          <div class="fw-bold">{{ request.user.email }}</div>
          {% if is_manager %}
            <span class="badge bg-warning text-dark">Manager</span>
          {% else %}
            <span class="badge bg-light text-dark">Customer</span>
          {% endif %}
        </div>
      </div>

      <nav class="nav flex-column">
        {% comment %} <a class="nav-link text-white {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}"
           href="{% url 'core:dashboard' %}">
          <i class="bi bi-speedometer2 me-2"></i>Огляд
        </a> {% endcomment %}
        {# Ролеты #}
        <a class="nav-link text-white {% if request.resolver_match.url_name == 'list' %}active{% endif %}"
          href="{% url 'orders:list' %}">
          <i class="bi bi-bag-check me-2"></i>Тканинні ролети
        </a>

        {# Комплектующие #}
        <a class="nav-link text-white {% if request.resolver_match.url_name == 'components_list' %}active{% endif %}"
          href="{% url 'orders:components_list' %}">
          <i class="bi bi-tools me-2"></i>Комплектуючі
        </a>
        {% if is_manager %}
          <a class="nav-link text-white {% if request.resolver_match.url_name == 'clients_list' or request.resolver_match.url_name == 'client_create' or request.resolver_match.url_name == 'profile_other' %}active{% endif %}"
            href="{% url 'accounts:clients_list' %}">
            <i class="bi bi-people me-2"></i>Клієнти
          </a>
          <a class="nav-link text-white {% if request.resolver_match.url_name == 'notifications_settings' %}active{% endif %}"
            href="{% url 'orders:notifications_settings' %}">
            <i class="bi bi-gear me-2"></i>Налаштування
          </a>
        {% endif %}
        <a class="nav-link text-white {% if request.resolver_match.url_name == 'balances' %}active{% endif %}"
          href="{% url 'orders:balances' %}">
          <i class="bi bi-cash-coin me-2"></i>
            {% if is_manager %}
              Баланси
            {% else %}
              Баланс
            {% endif %}
          
          
        </a>
        <a class="nav-link text-white {% if request.resolver_match.url_name == 'profile' %}active{% endif %}"
           href="{% url 'accounts:profile' %}">
          <i class="bi bi-person-circle me-2"></i>Профіль
        </a>
        {% if is_manager %}
          <a class="nav-link text-white" href="/admin/">
            <i class="bi bi-shield-lock me-2"></i>Адмінка
          </a>
        {% endif %}
      </nav>

      <hr class="border-white-50">
      {% comment %} <div class="small">
        <div class="opacity-75">Організація:</div>
        <div class="fw-semibold">
          {% if request.organization %}{{ request.organization.name }}{% else %}—{% endif %}
        </div>
      </div> {% endcomment %}
    </div>
  </aside>

  <!-- Main content -->
  <section class="col-12 col-lg-10">
    <div class="d-flex align-items-center justify-content-between mb-3">
      <h1 class="h4 m-0" style="width: 100%;">{% block dashboard_heading %}Кабінет{% endblock %}</h1>
      
    </div>
   

    <div class="card shadow-sm">
      <div class="card-body">
        {% block dashboard_content %}
        <!-- EN: Child templates put content here; UA: Вміст сторінки кабінету -->
        {% endblock %}
      </div>
    </div>
  </section>
</div>
{% endblock %}
